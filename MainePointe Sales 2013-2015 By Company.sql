Select Left(FoeDate,4) as Year, i.RDCategory as RD, i.SfCategory as Sf, '6' + case when left(o.conversionitemnumber,2) = '00' then Right(o.conversionitemnumber,5) else right(o.conversionItemNumber,6) end as ShipPack, '6' + case when left(o.itemnumber,2) = '00' then Right(o.itemnumber,5) else right(o.ItemNumber,6) end as Pack, o.CatalogCodePrefix, o.CatalogYear, c.CompanyDescription as Company, Sum(ItemQty) as Units, Sum(ItemQty*o.UnitPrice) as Dollars
from OrderlineAll o join Orders d on o.AccountNumber = d.AccountNumber and o.OrderNumber = d.OrderNumber left join item i on o.CatalogYEar = i.Season and o.CatalogCodePrefix = i.PrimaryCatalogCode and o.ItemNumber = i.ItemNumber
join MDW1.dbo.Company c on d.CompanyCode = c.Company
where FoeDate between '20130101' and '20151231' and d.OrderStatus = 'F' and ItemErrorFlag = ' ' and AvailabilityFlag in(' ','1')  and AddressSequence <>'000'
group by Left(FoeDate,4),  i.RDCategory, i.SfCategory, '6' + case when left(o.conversionitemnumber,2) = '00' then Right(o.conversionitemnumber,5) else right(o.conversionItemNumber,6) end, '6' + case when left(o.itemnumber,2) = '00' then Right(o.itemnumber,5) else right(o.ItemNumber,6) end, o.CatalogCodePrefix, o.CatalogYear, c.CompanyDescription